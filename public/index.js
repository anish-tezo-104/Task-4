(()=>{"use strict";class e{constructor(e,t,s,o){this.headerFunctions=e,this.addEmployeeFunctions=t,this.globalUtilityFunctions=s,this.filterOptions=o}toggleSubSecClass(e,t,s,o){const l=document.getElementById("employeeForm");e.classList.contains("unlocked")&&(e.classList.contains("active")?(e.classList.remove("active"),l.reset(),this.addEmployeeFunctions.resetProfileImage(),t.forEach((e=>{document.querySelector(e).classList.remove("active")}))):(window.innerWidth<=900&&document.querySelector(".sidebar").classList.contains("active")&&this.headerFunctions.toggleSideBar(),document.querySelectorAll(".sub-sec").forEach((e=>{e.classList.remove("active")})),e.classList.add("active"),t.forEach((e=>{document.querySelector(e).classList.add("active")}))),s.forEach((e=>{var t;null===(t=document.querySelector(e))||void 0===t||t.classList.remove("active")})))}handleUpdateDismiss(){document.querySelector(".update-message").classList.remove("active")}sidebarFilter(e){e.department[0],document.querySelectorAll(".dropdown-options").forEach((t=>{var s;const o=null===(s=t.getAttribute("value"))||void 0===s?void 0:s.trim().toLowerCase();e.department.includes(o||"")?(t.classList.add("active"),t.classList.add("selected")):(t.classList.remove("active"),t.classList.remove("selected"))}));const t=document.querySelector(".btn-apply"),s=document.querySelector(".btn-reset");t.disabled=!1,s.disabled=!1,0===e.department.length&&(t.disabled=!0,s.disabled=!0),e.department.length}populateDepartmentList(){const e=this.globalUtilityFunctions.getAllEmployeesFromLocalStorage(),t={};e&&e.forEach((e=>{const s=e.department||"Others";t[s]=(t[s]||0)+1}));const s=document.getElementById("departmentList");s.innerHTML="";const o=this.filterOptions.department;o.includes("Others")||o.push("Others"),o.forEach((e=>{const o=t[e]||0,l=this.generateDepartmentListItem(e,o);s.insertAdjacentHTML("beforeend",l),delete t[e]}));for(const e in t){const o=t[e],l=this.generateDepartmentListItem(e,o);s.insertAdjacentHTML("beforeend",l)}}generateDepartmentListItem(e,t){return`\n      <li onclick="ems.sideBarFunctions.sidebarFilter({ 'department': ['${e.trim().toLowerCase()}'] })">\n        <a href="#">\n          <div class="dept-details">\n            <div class="dept-names">${e}</div>\n            <div class="employee-dept-count">${t}</div>\n          </div>\n        </a>\n      </li>\n    `}}class t{constructor(){}toggleSideBar(){const e=document.querySelector(".sidebar"),t=document.querySelector(".grid-container"),s=document.querySelector(".sidebar-handle-icon img");if(e&&t&&s)if(e.classList.contains("active")){e.classList.remove("active"),t.style.gridTemplateColumns="6% 94%",document.querySelectorAll(".sub-sec-left-left img").forEach((e=>{e.style.paddingLeft="0.5rem"}));const o=document.querySelector(".sidebar-roles-icon"),l=document.querySelector(".sidebar-assign-user-icon");o&&(o.style.paddingLeft="0.3rem"),l&&(l.style.paddingLeft="0.3rem"),s&&(s.style.transform="rotate(-180deg)")}else{e.classList.add("active"),t.style.gridTemplateColumns="20% 80%",document.querySelectorAll(".sub-sec-left-left img").forEach((e=>{e.style.paddingLeft="1rem"}));const o=document.querySelector(".sidebar-roles-icon"),l=document.querySelector(".sidebar-assign-user-icon");o&&(o.style.paddingLeft="1rem"),l&&(l.style.paddingLeft="1rem"),s&&(s.style.transform="rotate(360deg)")}}handleBurger(e){const t=document.querySelector(".dropdown-content-header");t&&(t.classList.contains("active")?t.classList.remove("active"):t.classList.add("active"))}}class s{constructor(e,t,s,o,l,n,i,r,a,c,d,m,u,h){this.empNo=e,this.firstName=t,this.lastName=s,this.dob=o,this.email=l,this.mobileNumber=n,this.joiningDate=i,this.status=r,this.location=a,this.jobTitle=c,this.department=d,this.assignManager=m,this.assignProject=u,this.profileImageBase64=h}}class o{constructor(e){this.globalUtilityFunctions=e}populateSelectOptions(e,t){const s=document.getElementById(e);s?(s.innerHTML="",t.forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e,s.appendChild(t)}))):console.error(`Select element with id '${e}' not found.`)}handleAddEmployeesFormCancel(e,t){let s=document.getElementById("employeeForm");const o=document.getElementById("profileImagePreview");o&&(o.src="../assets/default-user.png"),s||console.error("Employee form not found.")}openProfileImageInput(){const e=document.getElementById("profileImageInput");e&&e.click()}handleFormSubmit(){const e=document.getElementById("employeeForm");if(e){const t=new FormData(e);this.validateForm(t)&&(this.createEmployeeFromFormData(t),e.reset(),this.resetProfileImage(),alert("Employee data added successfully!"))}else console.error("Employee form not found.")}createEmployeeFromFormData(e){const t=e.get("empNo"),o=e.get("firstName"),l=e.get("lastName"),n=new Date(e.get("dob")),i=e.get("email"),r=e.get("mobileNumber"),a=e.get("joiningDate"),c=e.get("location"),d=e.get("jobTitle"),m=e.get("department"),u=e.get("assignManager"),h=e.get("assignProject");let g="../assets/default-user.png";const p=e.get("profileImage");let y;if(p&&p.size>0){const e=new FileReader;e.readAsDataURL(p),e.onload=()=>{g=e.result,y=new s(t,o,l,n,i,r,a,!0,c,d,m,u,h,g),this.saveEmployeeToLocalStorage(y)}}else y=new s(t,o,l,n,i,r,a,!0,c,d,m,u,h,g),this.saveEmployeeToLocalStorage(y)}saveEmployeeToLocalStorage(e){let t=this.globalUtilityFunctions.getAllEmployeesFromLocalStorage()||[];e&&(t.push(e),localStorage.setItem("employees",JSON.stringify(t)));const s=document.getElementById("profileImagePreview");s&&(s.src="../assets/default-user.png")}validateForm(e){let t=!0;return["empNo","firstName","lastName","email","joiningDate"].forEach((e=>{const s=document.getElementById(e);s&&!s.value.trim()?(this.showInputErrorMessage(s),t=!1):s&&this.hideInputErrorMessage(s)})),t}previewProfileImage(e){var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){const e=new FileReader;e.onload=()=>{const t=document.getElementById("profileImagePreview");t&&(t.src=e.result)},e.readAsDataURL(s)}}showInputErrorMessage(e){const t=e.nextElementSibling;t&&t.classList.add("active")}hideInputErrorMessage(e){const t=e.nextElementSibling;t&&t.classList.remove("active")}resetProfileImage(){const e=document.getElementById("profileImagePreview");e&&(e.src="../assets/default-user.png")}}class l{constructor(){}loadEmployees(){this.getAllEmployeesFromLocalStorage()}handleSidebarResponsive(){const e=document.querySelector(".sidebar");e&&(window.innerWidth<=900?e.classList.remove("active"):e.classList.add("active"))}getAllEmployeesFromLocalStorage(){const e=localStorage.getItem("employees");return e?JSON.parse(e):[]}handlePostFormSubmissions(e,t,s){document.querySelectorAll(".error-message").forEach((e=>{e.classList.remove("active")})),t.forEach((e=>{const t=document.querySelector(e);t&&t.classList.add("active")})),s.forEach((e=>{const t=document.querySelector(e);t&&t.classList.remove("active")})),e.reset()}extractTableData(){let e=document.querySelector(".employees-table"),t=["","STATUS","more_horiz"],s=Array.from(e.querySelectorAll("th")).map((e=>{var t;let s=e.querySelector("span:first-child");return s?null===(t=s.textContent)||void 0===t?void 0:t.trim():""})),o=s.filter((e=>!t.includes(null!=e?e:""))),l=Array.from(e.querySelectorAll("tbody tr")),n=[];return l.forEach((e=>{let o=Array.from(e.querySelectorAll("td")).map(((e,o)=>{var l,n,i;if(!t.includes(null!==(l=s[o])&&void 0!==l?l:"")){let t=null===(n=e.textContent)||void 0===n?void 0:n.trim();return'"'+(null!==(i=null==t?void 0:t.replace(/"/g,'""'))&&void 0!==i?i:"")+'"'}return""}));o=o.filter((e=>""!==e)),o.length>0&&n.push(o)})),{headers:o,data:n}}toggleSelectOptions(){const e=document.querySelector(".select-items");e&&e.classList.toggle("select-hide")}updateGridTemplateColumns(){var e=window.innerWidth,t=document.querySelector(".sidebar"),s=document.querySelector(".grid-container");e>900&&t&&t.classList.contains("active")?s&&(s.style.gridTemplateColumns="20% 80%"):s&&(s.style.gridTemplateColumns="100%")}convertToCSV(e,t=[]){let s="";if(0===e.length)return s;const o=Object.keys(e[0]).filter((e=>!t.includes(e)));return s+='"'+o.join('","')+'"\n',e.forEach((e=>{let t=o.map((t=>{let s=e[t];return"string"==typeof s&&s.includes('"')&&(s=s.replace(/"/g,'""')),"string"==typeof s&&s.includes(",")&&(s='"'+s+'"'),s})).join(",");s+=t+"\n"})),s}downloadCSVFile(e,t){let s=new Blob([e],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(s),l=document.createElement("a");l.setAttribute("href",o),l.setAttribute("download",t),l.click(),URL.revokeObjectURL(o)}}const n=new class{constructor(){this.filterOptions={status:["Active","Inactive","All"],location:["Hyderabad","Delhi","Mumbai","Bangalore","Seattle","New York"],department:["IT","HR","Finance","Product Engineering","UI/UX","Management"]},this.main(),this.globalUtilityFunctions=new l,this.headerFunctions=new t,this.addEmployeeFunctions=new o(this.globalUtilityFunctions),this.sideBarFunctions=new e(this.headerFunctions,this.addEmployeeFunctions,this.globalUtilityFunctions,this.filterOptions)}main(){document.addEventListener("DOMContentLoaded",(()=>{this.includeHTML("./html/sidebar.html","sidebarContainer"),this.includeHTML("./html/header.html","headerContainer"),this.includeHTML("./html/employees.html","employeesContainer"),this.includeHTML("./html/addEmployee.html","addEmployeesContainer"),this.includeHTML("./html/role.html","roleContainer"),this.includeHTML("./html/addRoles.html","newRoleContainer"),this.includeHTML("./html/roleDesc.html","roleDescContainer")}))}includeHTML(e,t){fetch(e).then((e=>e.text())).then((s=>{this.globalUtilityFunctions.updateGridTemplateColumns();const o=document.getElementById(t);o&&(o.innerHTML+=s),this.handlePostProcessing(e)})).catch((t=>console.error(`Error fetching ${e}:`,t)))}handleEmployeesPage(e){"./html/employees.html"==e&&this.globalUtilityFunctions.loadEmployees()}handleAddEmployeePage(e){"./html/addEmployee.html"==e&&(document.getElementById("profileImageInput"),document.getElementById("addProfilePhotoButton"))}handleAddRolesPage(e){"./html/addRoles.html"==e&&(document.querySelector(".select-selected"),document.querySelector(".select-items"),document.querySelectorAll(".select-items input[type='checkbox']"))}handlePostProcessing(e){this.globalUtilityFunctions.handleSidebarResponsive(),this.sideBarFunctions.populateDepartmentList(),this.handleEmployeesPage(e),this.handleAddEmployeePage(e),this.handleAddRolesPage(e)}};window.ems=n})();